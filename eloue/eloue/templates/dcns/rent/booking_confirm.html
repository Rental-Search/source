{% extends "base.html" %}
{% load i18n product %}

{% block title %}{% trans "Confirmez votre réservation" %}{% endblock %}

{% block content %}
<div id="content-home" class="xgrid">
    <div id="wizard" class="x12">
        <div class="wizard-header">
            <h1>{% trans "Réservation" %}</h1>
        </div>
         <ol class="sbs-steps">
 			{% if not user.is_authenticated %}
 				<li>{% trans "1. Identifiez-vous" %}</li>
 				<li class="on">{% trans "2. Confirmez votre réservation" %}</li>
 			{% else %}
 				<li>{% trans "1. Information de contact" %}</li>
 				<li class="on">{% trans "2. Confirmez votre réservation" %}</li>
 			{% endif %}
 		</ol>
        <a href="{% url faq-topic-list %}" class="btn big-blue">{% trans "Obtenir de l'aide" %}</a>
    </div>
    <div class="x8">
        <div class="content-header x8 first">
            <h2>{% trans "Objet réservé" %}</h2>
        </div>
        <div class="x8 first" style="margin-bottom: 20px;">
            <form class="form" action="" method="POST">
            {% csrf_token %}
            <a class="pl-img" href="{{ object.get_absolute_url }}">
				{% with product.pictures.all|first as picture %}
          {% if picture.thumbnail %}
           <img src="{{ picture.thumbnail.url }}" alt="product.summary" />
          {% endif %}
         {% endwith %}
			</a>
			<div class="pl-header">
				<h2><a href="{{ product.get_absolute_url }}">{{ product.summary|capfirst|truncate:50 }}</a></h2>
			</div>
			<div class="pl-content">
				<div class="pl-desc">{{ product.description|truncate:100 }}</div>
				<div class="pl-distance">
					
				</div>
				<div class="pl-price">
				    {% with product.prices.day|first as price %}
					 <span class="price">{{ price }}</span><br />
					 <span class="unit">par {{ price.unit|unit }}</span>
					{% endwith %}
				</div>
			</div>
			<div class="pl-footer">
				Par <a href="{{ product.owner.get_absolute_url }}" class="owner">{{ product.owner.username }}</a> | {{ product.address.city|capfirst }}, {{ product.address.zipcode }}
			</div>
        </div>
        <div class="content-header x8 first">
			<h2>{% trans "Dates et total" %}</h2>
		</div>
		<div class="x8 first">
		    <table class="booking-resume">
                <tr>
                    <th>{% trans "Début :" %}</th>
                    <td>{{ preview.started_at|date:"l j F Y"|capfirst }}</td>
                </tr>
                <tr>
                    <th>{% trans "Fin :" %}</th>
                    <td>{{ preview.ended_at|date:"l j F Y"|capfirst }}</td>
                </tr>
                <tr>
                    <th>{% trans "Prix par jour :" %}</th>
                    <td class="number">{{ product.prices.day|first }}</td>
                </tr>
                <tr>
                    <th>{% trans "Durée de la location :" %}</th>
                    <td class="number">{{ preview.started_at|timesince:preview.ended_at }}</td>
                </tr>
                <tr class="total">
                    <th>{% trans "Total :" %}</th>
                    <td class="number">{{ preview.total_amount|currency }}</td>
                </tr>
            </table>
		</div>
		<div id="submit-wizard" class="x8 first">
		    <p>
		        <input type="hidden" name="{{ step_field }}" value="{{ step0 }}" />
    	        {{ previous_fields|safe }}
    			<a href="{{ product.get_absolute_url }}">{% trans "Annuler" %}</a> {% trans "ou" %}
    		    <input type="submit" class="btn big-green" value="{% trans "Payez" %}" />
    		</p>
		</div>
	  </form>
    </div>
    <div class="x4">
          <div class="box-info">
              {% if product.payment_type == 0 %}
              <h3>{% trans "Paiement hors ligne" %}</h3>
              <p>
                  {% trans "Le propriétaire souhaite le paiement hors ligne (chèque/espèce). Vous le payerez le premier jour de la location."%}
              </p>
              {% else %}
              <h3>{% trans "Paiement en ligne" %}</h3>
              <p>
                {% trans "Le propriétaire souhaite le paiement en ligne. Vous payez au moment de la réservation via PayPal. Le montant est débité lors du premier jour de location."%}
              {% endif %}
              </p>
         </div> 
	</div>
</div>
{% endblock %}