{% load i18n %}

<div id="fb-root"></div>
<div class="x6 or">
    <div class="fbconnect-content">
        <div id="fbconnect">Connectez-vous avec Facebook</div>
        <span class="fb-slogan">Plus simple et rapide.</span>
        <div class="fb-pile">
            <fb:facepile app_id="{{FACEBOOK_APP_ID}}" width="240" max_rows="1"></fb:facepile>
        </div>
    </div>
</div>
<div class="x6">
    <div class="emailOauth-content">
        {{ form.non_field_errors }}
    	<form class="inline" action="" method="POST">
    	{% csrf_token %}
        <p class="email">
            <label>{% trans "Votre adresse email est :" %}</label> {{ form.email }}
    		{% if form.email.errors %}
    		    {% for error in form.email.errors %}
    		        <span class="error">{{ error|escape }}</span>
    		    {% endfor %}
    		{% endif %}
        </p>
        <p class="question">{% trans "Avez-vous un compte ?" %}</p>
        {{ form.exists }}
    	{% if form.exists.errors %}
    	    {% for error in form.exists.errors %}
    	        <span class="error">{{ error|escape }}</span>
    	    {% endfor %}
    	{% endif %}
        <p class="password">
    		{{ form.password }}
    		<a href="{% url password_reset %}" class="pd-forget">{% trans "Mot de passe oubli√©" %}</a>
    		{% if form.password.errors %}
    		    {% for error in form.password.errors %}
    		        <span class="error">{{ error|escape }}</span>
    		    {% endfor %}
    		{% endif %}
    	</p>
    </div>
    <div id="submit-wizard">
        <p>
            {{ form.facebook_access_token }}
            {{ form.facebook_expires }}
            {{ form.facebook_uid }}
    	    <input type="hidden" name="{{ step_field }}" value="{{ step0 }}" />
        	{{ previous_fields|safe }}
        	<input type="submit" class="btn big-green" value="{% trans "Continuer &rarr;" %}" />
        </p>
    </form>
    </div>
</div>

<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '{{FACEBOOK_APP_ID}}', // App ID
      channelUrl : '{{ MEDIA_URL }}channel.html', // Channel File
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    });

    // Additional initialization code here
  };

  // Load the SDK Asynchronously
  (function(d){
     var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/fr_FR/all.js";
     d.getElementsByTagName('head')[0].appendChild(js);
   }(document));
</script>