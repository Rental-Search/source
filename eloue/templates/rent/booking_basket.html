{% extends "base.html" %}
{% load i18n booking %}

{% block content %}
<div class="top-content container clearfix">
	<h1>{% trans "Panier de réservation"%}</h1>
</div>{# top-content #}
<div class="booking content container clearfix">
	<div class="cart grid9 first">
		<div class="headB grid9 first">	
		 {% if has_dates %}
			 <strong>Du</strong> {{ form.started_at.data|combine|date:"l j F Y" }} <strong>au</strong> {{ form.ended_at.data|combine|date:"l j F Y" }} <a href="#">(Modifier les dates)</a>
		 {% endif %}	
		</div>
		<div class="resumeB grid9 first">
			<a class="imgpl">
			 {% with product.pictures.all|first as picture %}
			  {% if picture.thumbnail %}
			   <img src="{{ picture.thumbnail.url }}" />
			  {% endif %}
			 {% endwith %}
			</a>
			<div class="dpl">
				<h3>
					<a href="#">{{ product.summary }}</a>
				</h3>
				<div class="descpl">
					{{ product.description|truncatewords:30|safe }}
				</div>
				<div class="displ">
					
				</div>
				<div class="ownpl">
					<span>Lieu : </span>{{ product.address.zipcode }} {{ product.address.city|capfirst }} - 
					<span>Propriétaire : </span><a href="#">{{ product.owner }}</a>
				</div>
			</div>
			<div class="bpl">
			 {{ product.prices.day|first }}&euro;/J
			</div>
		</div><!-- resumeB -->
		{% if has_dates %}
		 <div class="totalB grid9 first">
			<strong>{% trans "Total :" %}</strong> {{ total_amount }}€
		 </div><!-- totalB -->
		 <div class="submitB grid9 first">
		  <form class="booking-date" action="" method="POST">
		   {{ form.started_at.as_hidden }}
		   {{ form.ended_at.as_hidden }}
		   <input type="hidden" name="{{ step_field }}" value="{{ step0 }}" />
       {{ previous_fields|safe }}{% csrf_token %}	
		   <a href="{{ product.get_absolute_url }}">{% trans "Annuler" %}</a> <span>ou</span> <input type="submit" value="Valider" class="grey button medium">
		  </form>
		 </div><!-- totalB -->
		{% endif %}
	</div><!-- cart -->
	<div class="infoB grid3">
		<h5>Etapes de réservation</h5>
		<ol>
			<li>Identifiez-vous</li>
			<li>Enregistrez votre paiement</li>
		</ol>
	</div><!-- infoB -->
	{{ form.errors }}
	<div class="grid7 first">
		<h4>Modifier vos dates de réservation :</h4>
		<div class="data pam">
			<form class="booking-date" action="" method="POST">
		  	{% csrf_token %}
				<table class="grid7 first">
					<tr>
						<th class="txtT">
							<label class="labb">Date de début * :</label>
						</th>
						<td>
							{{ form.started_at }}
						</td>
					</tr>
					<tr>
						<th class="txtT"><label class="labb">Date de fin * :</label></th>
						<td>{{ form.ended_at }}</td>
					</tr>
					<tr>
						<td class="submit" colspan="2">
						  {{ form.basket }}
							<input type="hidden" name="{{ step_field }}" value="{{ step0 }}" />
					  	{{ previous_fields|safe }}
							<input type="submit" value="Valider" class="button grey medium"/>
						</td>
					</tr>
				</table>
			</form>
		</div>
	</div>
</div>{# content #}
{% endblock %}